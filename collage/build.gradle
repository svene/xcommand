//apply plugin: JavaCCPlugin

dependencies {
	compile project(':xcommand')
	compile "commons-lang:commons-lang:2.3"
	compile "jboss:javassist:3.6.ga"
	compile "net.java.dev.javacc:javacc:4.0"
}

//______________________________________________________

task jcc0 (dependsOn: 'renameJCC') {
	def inputFile = 'templateparser.jj' 
	def genDir = 'build/org/collage/jcc'

	inputs.file inputFile
	outputs.dir genDir

	doLast {
		println "generate jcc source"
		ant.mkdir(dir: 'build/_artifacts')
		ant.mkdir(dir: 'build/org/collage/jcc')
		ant.javacc(target: inputFile, outputdirectory: genDir, javacchome: 'build/_artifacts')
	}

	sourceSets.main.java.srcDir(genDir)
}

task jcc (dependsOn: 'renameJCC', type: JavaCCTask) {
	inputFile = 'templateparser.jj' 
}

compileJava.dependsOn(jcc)


class JavaCCTask extends DefaultTask {
	@InputFile
	def inputFile = 'xxx.jj' 

	@OutputDirectory
	def genDir = 'build/org/collage/jcc'

	@TaskAction
	void execute() {
		println "generate jcc source"
		ant.mkdir(dir: genDir)
		ant.javacc(target: inputFile, outputdirectory: genDir, javacchome: 'build/_artifacts')

		project.sourceSets.main.java.srcDir(genDir)
	}

}

//______________________________________________________


task listJars << {
    configurations.compile.each { File file ->
                println file.name
        }
}






